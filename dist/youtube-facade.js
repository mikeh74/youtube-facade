(()=>{let e;let t=e=>{if(!e||"string"!=typeof e){console.error("addPreconnect: Invalid URL");return}try{let t=document.createElement("link");t.rel="preconnect",t.href=e,document.head.appendChild(t)}catch(e){console.error("addPreconnect: Failed to add preconnect link",e)}},o=(()=>{let e=!1,o=["https://www.youtube-nocookie.com","https://www.google.com"];return()=>{e||(o.forEach(e=>t(e)),e=!0)}})();function r(e){if(!e||!(e instanceof HTMLElement))return console.error("getYoutubeVideoId: Invalid element"),null;let t=e.getAttribute("data-youtube-id");if(t)return t;let o=e.getAttribute("href");if(!o)return null;try{t=new URL(o).searchParams.get("v")}catch(e){return console.error("getYoutubeVideoId: Failed to parse href",e),null}return t}function a(){return window.innerWidth<600&&navigator.userAgent.includes("Mobi")}function n(e,t,o,r,a=!1){let l=e===document;if(!l&&!(e instanceof HTMLElement)){console.error("delegateEvent: Invalid parent element");return}if("string"!=typeof t||"string"!=typeof o||"function"!=typeof r){console.error("delegateEvent: Invalid arguments");return}(l?document:e).addEventListener(t,function(e){let t=e.target.closest(o);t&&(l||this.contains(t))&&r.call(t,e)},a)}function l(e){if(!e||!(e instanceof HTMLElement))return console.error("getTargetElement: Invalid element"),null;let t=e.getAttribute("data-target");if(t){let e=document.querySelector(t);return e||(console.error("getTargetElement: Target element not found for selector:",t),null)}return e}let u=async(e,t)=>{if(!e||!(e instanceof HTMLElement)||"IMG"!==e.tagName){console.error("populateYoutubeImg: Invalid element (must be IMG)");return}let o=`https://img.youtube.com/vi/${t}/`,r=["maxresdefault","sddefault","hqdefault","mqdefault","default"].map(e=>`${o}${e}.jpg`);async function a(e){for(let t of e)try{let e=await fetch(t);if(200===e.status)return e}catch(e){console.warn("Could not find a valid youtube image:",e)}return null}let n=await a(r);n&&(e.src=n.url)};var c=(e=".youtube-facade")=>{document.querySelectorAll(`${e}[data-use-youtube-thumb]`).forEach(e=>{let t=null;if("IMG"===e.tagName)t=e;else if(!(t=e.querySelector("img"))){console.error("checkForThumbs: No IMG found in element",e);return}let o=r(e);o&&u(t,o)})};let d=!1,i=null;async function s(){return d?Promise.resolve(window.YT):i||(i=new Promise((e,t)=>{try{var o=document.createElement("script");o.src="https://www.youtube.com/iframe_api",o.onerror=e=>{console.error("YouTube Iframe API script failed to load",e),t(Error("YouTube Iframe API script failed to load"))};var r=document.getElementsByTagName("script")[0];if(!r||!r.parentNode){console.error("No script tag found in document for YouTube API insertion"),t(Error("No script tag found in document for YouTube API insertion"));return}r.parentNode.insertBefore(o,r),window.onYouTubeIframeAPIReady=()=>{let o=window.YT;if(!o){t(Error("YouTube Iframe API did not initialize correctly"));return}d=!0,e(o)}}catch(e){console.error("Error loading YouTube Iframe API",e),t(e)}}))}async function f(e,t,o,r){if(!e)throw Error("createYouTubePlayer: elementId is required");if(!t||"string"!=typeof t)throw Error("createYouTubePlayer: videoId is required and must be a string");try{return new(await s()).Player(e,{width:"720",height:"405",videoId:t,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",playerVars:o,events:{onReady:r}})}catch(e){throw console.error("createYouTubePlayer: Failed to create player",e),e}}let m=(e=`
      <div class="youtube-facade-modal-content">
        <button class="youtube-facade-modal-close" data-youtube-modal-close aria-label="Close modal">
          <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
            <path class="youtube-facade-model-close-svg" fill="#ffffff" d="M 16.830797 20.000301 L 10.000151 13.16957 L 3.169428 20.000301 L -0 16.830883 L 6.830741 10.000151 L -0 3.169418 L 3.169428 0 L 10.000151 6.830732 L 16.830797 0 L 20 3.169418 L 13.16958 10.000151 L 20 16.830883 Z"/>
          </svg>
        </button>
        <div class="youtube-facade-modal-content-inner">
          <div id="youtube-facade-modal-placeholder"
            class="youtube-facade-modal-inner"></div>
        </div>
      </div>
    `,{get:()=>e,set:t=>{"string"==typeof t&&(e=t)}}),y=()=>{let e=document.createElement("div");e.classList.add("youtube-facade-modal"),e.innerHTML=m.get(),document.body.appendChild(e),document.querySelectorAll("[data-youtube-modal-close]").forEach(e=>{e.addEventListener("click",()=>{p()})}),document.addEventListener("keydown",e=>{("Escape"===e.key||"Esc"===e.key)&&p()})},b=()=>{let e=document.querySelector(".youtube-facade-modal");if(!e){console.error("toggleModal: Modal not found");return}e.classList.toggle("youtube-facade-modal-active"),e.classList.contains("youtube-facade-modal-active")?document.body.classList.add("youtube-facade-body-no-scroll"):document.body.classList.remove("youtube-facade-body-no-scroll")},p=()=>{requestAnimationFrame(()=>{let e=document.querySelector(".youtube-facade-modal"),t=document.querySelector("#youtube-facade-modal-placeholder");t&&(t.innerHTML=""),document.querySelectorAll(".youtube-facade-loading").forEach(e=>e.classList.remove("youtube-facade-loading")),e&&e.classList.remove("youtube-facade-modal-active"),document.body.classList.remove("youtube-facade-body-no-scroll")})};window.youtubeFacade=({selector:e=".youtube-facade",muteForAutoplay:t=!0,customModalTemplate:u=null}={})=>{u&&"string"==typeof u&&m.set(u),c(e),y();let d={playsinline:1,autoplay:1,rel:0};t&&a()&&(d.mute=1),n(document,"click",e,t=>{t.preventDefault();let o=t.target.closest(e);if(!o){console.error("youtubeFacade: Clicked element not found for selector",e);return}(function(e,t){if(!e||!(e instanceof HTMLElement)){console.error("handleVideoClick: Invalid element");return}let o=r(e);if(!o){console.error("handleVideoClick: No videoId found");return}let n=function(e){if(e.hasAttribute("data-use-youtube-api")){let t=e.getAttribute("data-use-youtube-api");return"string"!=typeof t||"false"!==t.trim().toLowerCase()}return navigator.vendor.includes("Apple")||navigator.userAgent.includes("Mobi")}(e);e.hasAttribute("data-mute-for-mobile")&&a()&&(t.mute=1),n?function(e,t,o){if(!e||!(e instanceof HTMLElement)){console.error("renderYoutubePlayer: Invalid element");return}let r=e.getAttribute("data-youtube-modal"),a=l(e);if(!a){console.error("No matching target for element",e);return}if(r){let e=document.getElementById("youtube-facade-modal-placeholder");if(!e){console.error("renderYoutubePlayer: Modal placeholder not found");return}let t=document.createElement("div");t.classList.add("youtube-facade-iframe"),e.appendChild(t),a=t,b()}e.classList.add("youtube-facade-loading"),f(a,t,o,function(t){t.target.playVideo(),e.classList.remove("youtube-facade-loading")}).then(t=>{window.yfplayer=t,e===a||r||(e.classList.add("youtube-facade-active"),e.tabIndex="-1")}).catch(e=>{console.error("renderYoutubePlayer: Failed to create YouTube player",e)})}(e,o,t):function(e,t,o){if(!e||!(e instanceof HTMLElement)){console.error("renderYouTubeIframe: Invalid element");return}let r=function(e,t){if(!e||"string"!=typeof e)return console.error("createYouTubeIframe: Invalid videoId"),null;let o=new URLSearchParams(t).toString(),r=document.createElement("iframe");return r.setAttribute("src",`https://www.youtube-nocookie.com/embed/${e}?${o}`),r.setAttribute("width","720"),r.setAttribute("height","405"),r.setAttribute("class","youtube-facade-iframe"),r.setAttribute("frameborder","0"),r.setAttribute("allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"),r.setAttribute("allowfullscreen",""),r}(t,o);if(e.getAttribute("data-youtube-modal")){b();let e=document.querySelector("#youtube-facade-modal-placeholder");if(!e){console.error("renderYouTubeIframe: Modal content not found");return}e.appendChild(r)}else{let t=l(e);if(!t)return;t.replaceWith(r),e!==t&&(e.classList.add("youtube-facade-active"),e.tabIndex="-1")}}(e,o,t),function(e,t){let o=new CustomEvent("youtube-facade-active",{detail:{element:e,videoId:t},bubbles:!0});e.dispatchEvent(o)}(e,o)})(o,d)}),n(document,"focusin",e,o,{once:!0}),document.querySelectorAll(e).forEach(e=>{e.addEventListener("pointerover",o,{once:!0})})}})();
//# sourceMappingURL=youtube-facade.js.map
